<#global content>
<div class='span3 left section toc'>
	<ul>
		<li><a href="#introduction">1. Introduction</a></li>
		<li><a href="#configuration">2. Google Spreadsheet configuration</a></li>
		<li><a href="#entity-wrapper">3. Google Spreadsheet file store wrapper configuration</a></li>
		<li><a href="#using">4. Using the file store wrapper</a></li>
	</ul>
</div>
<div class='span6 left section'>
	<h3>Turn your Google Spreadsheets into Web APIs</h3>

	<h4>
		<a id="introduction" name="introduction"></a>1. Introduction
	</h4>

	<p>This tutorial describes how to implement a Google Spreadsheet entity store wrapper to use data configured in this platform.</p>

	<p>We have a spreadsheet with a worksheet named Contact with following columns and containg a list of contact :</p>

	<ul>
		<li><strong>contact_id</strong> : autogenerated primary key</li>
		<li><strong>lastName</strong> (string) : last name</li>
		<li><strong>firstName</strong> (string) : first name</li>
		<li><strong>age</strong> (integer) : age</li>
	</ul>

	<p>We want to use these data and expose them as an API using APISpark and its Google Spreadsheet support (entity store wrapper).</p>

	<h4>
		<a id="configuration" name="configuration"></a>2. Google Spreadsheet configuration
	</h4>

	<p>There is nothing special to do. You simply need to have a spreadsheet with a worksheet named Contact.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-01.png">
    </p>
	<h4>
		<a id="entity-wrapper" name="entity-wrapper"></a>3. Google Spreadsheet entity store wrapper configuration
	</h4>

	<p>The second step is to plug your API on your existing worksheet. Fortunately the Google Spreadsheet platform provides intropection support of existing sheets. This means that APISpark can provide automatic configuration.</p>

	<p>Firstly you need to create an entity store with a source of type “Google Spreadsheet”. This is the way to create a Google Spreadsheet entity store wrapper.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-02.png">
    </p>

	<p>Then configure the general hints to access your spreadsheets in the Settings tab (entry Google Account), meaning setting the user identifier and password.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-03.png">
    </p>

	<p>Now you have these hints configured and tested connection, you can import a sheet. APISpark automatically detects all spreadsheets of your account.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-04.png">
    </p>

	<p>After importing the sheet, you can select the corresponding work sheets to import from the list on the left menu. This allows displaying hints about the sheets and gives the ability to select the wished worksheets with the Update work sheets button.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-05.png">
    </p>

	<p>You can then go on the Entities tab to automatically create the associated entities like for classical entity stores. You can notice that one entity will be created for each work sheet using the Add entities button.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-06.png">
    </p>

	<p>In our case, a Contact entity was automatically created. The first line of the worksheet is used to determine the properties of the entity to add.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-07.png">
    </p>

	<p>The corresponding mappings for entity and its fields are also automatically created.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-08.png">
    </p>

	<h4>
		<a id="using" name="using"></a>4. Using the entity store wrapper
	</h4>

	<p>Since such an entity store wrapper is an entity store, you can simply import it from a Web API and use it to build your API. See the basic tutorial for more details on this feature.</p>

	<p>Nevertheless you need to deploy your store to make it actually usable at runtime. For this simply use the "Deploy" button in the store header.</p>

    <p>
	    <img width="533" src="/images/tutorials/tutorial-spreadsheet-09.png">
    </p>

</div>
</#global>
