<#global content>
<div class='span3 left section toc'>
	<ul>
		<li><a href="#tutorial-jdbc-introduction">1. Introduction</a></li>
		<li><a href="#tutorial-jdbc-configuration">2. Database configuration</a></li>
		<li><a href="#tutorial-jdbc-entity-wrapper">3. JDBC entity store wrapper configuration</a></li>
		<li><a href="#tutorial-jdbc-using">4. Using the entity store wrapper</a></li>
	</ul>
</div>
<div class='span6 left section'>
	<h3>JDBC support in APISpark</h3>

	<h4>
		<a id="tutorial-jdbc-introduction" name="tutorial-jdbc-introduction"></a>1. Introduction
	</h4>

	<p>This tutorial describes how to implement a JDBC entity store wrapper to use data of a JDBC-compliant database in this platform.</p>

	<p>We have a SQL table named Contact with following fields :</p>

	<ul>
		<li><strong>id</strong> (int): autogenerated primary key</li>
		<li><strong>lastName</strong> (varchar) : last name</li>
		<li><strong>firstName</strong> (string) : first name</li>
		<li><strong>age</strong> (int) : age</li>
	</ul>

	<p>We want to use these data and expose them as an API using APISpark and its JDBC support (entity store wrapper).</p>

	<h4>
		<a id="tutorial-jdbc-configuration" name="tutorial-jdbc-configuration"></a>2. Database configuration
	</h4>

	<p>This tutorial doesn’t describe how to configure the database but you simply have to create a database containing a Contact table and configure access right.</p>

	<ul><li>connect the database engine using the MYSQL console:</li></ul>

	<pre>$ mysql -u root -p</pre>

	<ul><li>create a database and switch to it:</li></ul>

	<pre>mysql> create database apispark;
	Query OK, 1 row affected (0.01 sec)
	mysql> use apispark;
	Database changed</pre>

	<ul><li>create an InnoDB table named T_CONTACT with fields previously listed:</li></ul>

	<pre>CREATE TABLE T_CONTACT (
	  ID VARCHAR(255), 
	  LAST_NAME VARCHAR (255),
	  FIRST_NAME VARCHAR (255),
	  AGE INT,
	  PRIMARY KEY(ID)
	) TYPE = InnoDB;</pre>

	<p>Note : At the moment, the primary key of the table must be of type VARCHAR or CHAR since APISpark manages primary keys as strings. Primary keys are autogenerated as UUID. In future version, we’ll be able to disable primary key autogeneration and use other types for them.</p>

	<h4>
		<a id="tutorial-jdbc-entity-wrapper" name="tutorial-jdbc-entity-wrapper"></a>3. JDBC entity store wrapper configuration
	</h4>

	<p>The second step is to plug your API on your existing SQL table. Fortunately the JDBC technology provides intropection support of databases. This means that APISpark can provide automatic configuration.</p>

	<p>Firstly you need to create an entity store with a source of type “JDBC”. This is the way to create a JDBC entity store wrapper.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-01.png"
                   width="533">
    </p>

	<p>Then configure the general hints to access your JDBC application in the Settings tab (entry JDBC Account), meaning setting the driver (database type), host and port, username and password previously gotten.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-02.png"
                   width="533">
    </p>

	<p>Since the JDBC technology supports instropection, APISpark gives the ability to configure your entity store automatically. For this, you simply need to import a catalog in the settings tab:</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-03.png"
                   width="533">
    </p>

	<p>The catalog list contains all the databases visible by the specified user. Now the dependency is created your can import the tables you want to use in your store by clicking on the “Update tables” button. In our case, we import the T_CONTACT table.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-04.png"
                   width="533">
    </p>

	<p>The next step is to go in the Entities tab to automatically create entities based on the imported tables. This can be done using the “Add entities” button. APISpark formats entity and entity field names when doing this operation.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-05.png"
                   width="533">
    </p>

	<p>We have now an entity for our entity store called Contact.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-06.png"
                   width="533">
    </p>

	<p>Fields correspond to ones present in the database table.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-07.png"
                   width="333">
    </p>

	<p>APISpark automatically maps hints of the entity to the table for entity and fields.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-08.png"
                   width="533">
    </p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-09.png"
                   width="533">
    </p>

	<h4>
		<a id="tutorial-jdbc-using" name="tutorial-jdbc-using"></a>3. Using the entity store wrapper
	</h4>

	<p>Since such an entity store wrapper is an entity store, you can simply import it from a Web API and use it to build your API. See the basic tutorial for more details on this feature.</p>

	<p>Nevertheless you need to deploy your store to make it actually usable at runtime. For this simply use the "Deploy" button in the store header.</p>

    <p>
	    <img src="/images/tutorials/tutorial-jdbc-10.png"
                   width="533">
    </p>

</div>
</#global>
